<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
        <script>
            /* global $ */
            window.accessTokenParser = {
                accessToken     : null,
                endPoint        : '../index.php/auth/google/callback',
                getAccessToken  : function() {
                    var hash = window.location.href.substr(window.location.href.indexOf('#')+1);
                    // console.log('hash: ', hash);
                    this.accessToken = hash.split('=')[1];
                    // console.log('accessToken: ', accessToken);
                },
                sendToken : function() {
                    // submit as empty post, with "Authorization" header
                    // console.log('sending accessToken: ', this.accessToken);
                    // console.log('to endpoint: ', this.endPoint);
                    
                    $.ajax({
                        type: 'POST',
                        url: this.endPoint,
                        headers: {
                            "Authorization": this.accessToken
                        }
                    }).done(function(data) { 
                        // console.log('submitted accessToken, response data: ', data);
                        window.close();
                    });
                    
                },
                doStuff : function() {
                    this.getAccessToken();
                    this.sendToken();
                }
            };
        </script>
        <script>
            /* global $ */
            // after dom has loaded
            $(function() {
                // parse the url for access token and submit to backend, then close this endpoint/receptacle
                // window.accessTokenParser.doStuff();
            });
        </script>
    </head>
    <body>
        <!-- for testing 
        <button onclick="window.accessTokenParser.doStuff()">doStuff</button>
        -->
    </body>
</html>
