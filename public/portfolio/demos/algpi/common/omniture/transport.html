<!DOCTYPE html>
<html>
  <head>
    <title>Omniture Tracking Transport</title>
    
    <!-- Omniture prep -- parse the publication title (section/extension etc) from the url queryString -->
    <script>
      var queryString = window.location.search;
      var queryString = queryString.substring(1);
      var parseQueryString = function( queryString ) {
        var params = {}, queries, temp, i, l;
       
          // Split into key/value pairs
          queries = queryString.split("&");
       
          // Convert the array of strings into an object
          for ( i = 0, l = queries.length; i < l; i++ ) {
              temp = queries[i].split('=');
              params[temp[0]] = temp[1];
          }
       
          return params;
      };
      var queryParams = parseQueryString(queryString);
      
      window.omnitureSection    = decodeURIComponent(queryParams.section);
      window.omnitureExtension  = decodeURIComponent(queryParams.extension);
      window.showDevice					= decodeURIComponent(queryParams.showDevice).trim() === 'true';
      window.debugTransport			= decodeURIComponent(queryParams.debugTransport).trim() === 'true';
      
      window.deviceExtension = 
				window.showDevice
					? ( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) 
							? ' - (Mobile)'
						: ( /iPad/i.test(navigator.userAgent) )
							? ' - (iPad)'
						:	''
					: ''
			;
			
			window.parsedOmniturePath = 
				'indystar :/story/' 
				+ window.omnitureSection  
				+ '/' 
				+ window.omnitureExtension 
				+ window.deviceExtension
			;
			
			if (window.debugTransport) {
      	console.log('queryParms: ', queryParams);
      	console.log('omniture section: ', window.omnitureSection);
      	console.log('omniture extension: ', window.omnitureExtension);
      	console.log('omniture showDevice: ', window.showDevice);
      	console.log('REPORTING TO OMNITURE -- parsedOmniturePath: ', window.parsedOmniturePath);	
      }
			
		</script>
	</head>
	<body>
		
		
		
		
		<!-- Omniture execute -->
		<script type="text/javascript" src="http://www.indystar.com/static/js/cobrand/analytics.js"></script>
		<script type="text/javascript">
			var ad_web_service = 'static/'; /* just an example */
		  utag_data = {
		    cst						: ad_web_service,
		    instance			: 'prod', /* or 'qa' or 'prod' */
		    partner_type	: 'cobrand',
		        
				pathName			: window.parsedOmniturePath, // 'static--'+document.location.pathname
		    profile				: 'indystar',
		    ssts					: 'static'
		  };
		  
		  // Load Analytics
		  cobrandPageLoad(utag_data);
		</script>
		
	</body>
</html>